{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '33349547-44f128e159fc9ba4be7374396';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const DEFAULT_PER_PAGE = 15;\n\nconst queryParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 15,\n};\n\nexport async function fetchPhotos(payload) {\n  const {query, page = 1, limit = DEFAULT_PER_PAGE} = payload;\n\n  await new Promise(resolve => setTimeout(resolve, 5000));\n\n  const queryParamsObject = new URLSearchParams({\n    ...queryParams,\n    q: query,\n    page,\n    per_page: limit\n  });\n\n  const path = BASE_URL + '?' + queryParamsObject.toString();\n\n  const response = await axios.get(path);\n\n  return response.data;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst gallery = document.querySelector('.gallery');\n\nfunction getCardMarkup(item) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = item;\n  return `\n        <div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" target=\"_blank\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"info\">\n            <div class=\"info-item\"><b>${likes}</b>Likes</div>\n            <div class=\"info-item\"><b>${views}</b>Views</div>\n            <div class=\"info-item\"><b>${comments}</b>Comments</div>\n            <div class=\"info-item\"><b>${downloads}</b>Downloads</div>\n          </div>\n        </div>`;\n}\n\nexport function renderGallery(list){\n  const markup = list.map(item => getCardMarkup(item)).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPhotos, DEFAULT_PER_PAGE } from './js/pixabay-api';\nimport { renderGallery } from './js/render-functions';\n\nconst form = document.querySelector('#searchForm');\nconst loaderContainer = document.querySelector('.loader-container');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst gallery = document.querySelector('.gallery');\n\nconst LS_KEY = 'queryParams';\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  localStorage.removeItem(LS_KEY);\n  gallery.innerHTML = '';\n  loadMoreBtn.style.display = 'none';\n\n  const query = form.search.value.trim();\n\n  if (!query.length) {\n    iziToast.info({\n      message: 'Search should not be empty!',\n    });\n    return;\n  }\n\n  try {\n    loaderContainer.style.display = 'flex';\n    const response = await fetchPhotos({ query });\n\n    if (!response.hits.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    localStorage.setItem(\n      LS_KEY,\n      JSON.stringify({ query, totalHits: response.totalHits, currentPage: 1 })\n    );\n\n    form.search.value = '';\n    renderGallery(response.hits);\n    loadMoreBtn.style.display = 'block';\n  } catch (error) {\n    iziToast.error({\n      message: `Oooops...Something went wrong... ${error.message}`,\n    });\n    loadMoreBtn.style.display = 'none';\n  } finally {\n    loaderContainer.style.display = 'none';\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  try {\n    loaderContainer.style.display = 'flex';\n    loadMoreBtn.style.display = 'none';\n\n    const queryParams = JSON.parse(localStorage.getItem(LS_KEY));\n\n    if (!queryParams || !Object.keys(queryParams).length) {\n      return;\n    }\n\n    const { query, currentPage, totalHits } = queryParams;\n\n    let limit = DEFAULT_PER_PAGE;\n    const alreadyRenderedAmount = currentPage * limit;\n    const amountLeft = totalHits - alreadyRenderedAmount;\n\n    if (amountLeft <= 0) {\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      loadMoreBtn.style.display = 'none';\n      return;\n    }\n\n    if (amountLeft < limit) {\n      limit = amountLeft;\n    }\n\n    const response = await fetchPhotos({ query, page: currentPage + 1, limit });\n\n    localStorage.setItem(\n      LS_KEY,\n      JSON.stringify({ query, currentPage: currentPage + 1, totalHits })\n    );\n\n    renderGallery(response.hits);\n\n    const card = document.querySelector('.photo-card');\n    if (card) {\n      const cardHeight = card.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    loadMoreBtn.style.display = 'block';\n  } catch (error) {\n    iziToast.error({\n      message: `Oooops...Something went wrong... ${error.message}`,\n    });\n  } finally {\n    loaderContainer.style.display = 'none';\n  }\n});\n"],"names":["API_KEY","BASE_URL","DEFAULT_PER_PAGE","queryParams","fetchPhotos","payload","query","page","limit","resolve","queryParamsObject","path","axios","lightbox","SimpleLightbox","gallery","getCardMarkup","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","list","markup","form","loaderContainer","loadMoreBtn","LS_KEY","e","iziToast","response","error","currentPage","totalHits","alreadyRenderedAmount","amountLeft","card","cardHeight"],"mappings":"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"}