{"version":3,"file":"index.js","sources":["../src/js/constants.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/helpers.js","../src/main.js"],"sourcesContent":["const API_KEY = '33349547-44f128e159fc9ba4be7374396';\nexport const BASE_URL = 'https://pixabay.com/api/';\nexport const DEFAULT_PER_PAGE = 200;\n\nexport const defaultQueryParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 15,\n};\n\nexport const defaultState = {\n  query: '',\n  totalHits: 0,\n  currentPage: 0,\n}","import axios from 'axios';\nimport {BASE_URL, DEFAULT_PER_PAGE, defaultQueryParams} from './constants';\n\nexport async function fetchPhotos(payload) {\n  const {query, page = 1, limit = DEFAULT_PER_PAGE} = payload;\n\n  await new Promise(resolve => setTimeout(resolve, 5000));\n\n  const queryParamsObject = new URLSearchParams({\n    ...defaultQueryParams,\n    q: query,\n    page,\n    per_page: limit\n  });\n\n  const path = BASE_URL + '?' + queryParamsObject.toString();\n\n  const response = await axios.get(path);\n\n  return response.data;\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst gallery = document.querySelector('.gallery');\n\nfunction getCardMarkup(item) {\n  const {\n    webformatURL,\n    largeImageURL,\n    tags,\n    likes,\n    views,\n    comments,\n    downloads,\n  } = item;\n  return `\n        <div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" target=\"_blank\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"info\">\n            <div class=\"info-item\"><b>${likes}</b>Likes</div>\n            <div class=\"info-item\"><b>${views}</b>Views</div>\n            <div class=\"info-item\"><b>${comments}</b>Comments</div>\n            <div class=\"info-item\"><b>${downloads}</b>Downloads</div>\n          </div>\n        </div>`;\n}\n\nexport function renderGallery(list){\n  const markup = list.map(item => getCardMarkup(item)).join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}","const loaderContainer = document.querySelector('.loader-container');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('#searchForm');\n\nexport function showLoader() {\n  loaderContainer.style.display = 'flex';\n}\n\nexport function hideLoader() {\n  loaderContainer.style.display = 'none';\n}\n\nexport function showLoadMoreBtn() {\n  loadMoreBtn.style.display = 'block';\n}\n\nexport function hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n\nexport function resetGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function resetFormInput() {\n  form.search.value = '';\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPhotos } from './js/pixabay-api';\nimport { renderGallery } from './js/render-functions';\nimport {\n  showLoader,\n  hideLoader,\n  showLoadMoreBtn,\n  hideLoadMoreBtn,\n  resetGallery,\n  resetFormInput,\n} from './js/helpers';\nimport { DEFAULT_PER_PAGE, defaultState } from './js/constants';\n\nconst form = document.querySelector('#searchForm');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet currentState = {\n  query: '',\n  totalHits: 0,\n  currentPage: 0,\n};\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  resetGallery();\n  hideLoadMoreBtn();\n  currentState = { ...defaultState };\n\n  const searchQuery = form.search.value.trim();\n\n  if (!searchQuery.length) {\n    iziToast.info({\n      message: 'Search should not be empty!',\n    });\n    return;\n  }\n\n  currentState.query = searchQuery;\n\n  try {\n    showLoader();\n    const response = await fetchPhotos({ query: searchQuery });\n\n    if (!response.hits.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    currentState.totalHits = response.totalHits;\n    currentState.currentPage += 1;\n\n    resetFormInput();\n    renderGallery(response.hits);\n\n    if (response.totalHits > DEFAULT_PER_PAGE) {\n      showLoadMoreBtn();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: `Oooops...Something went wrong... ${error.message}`,\n    });\n    hideLoadMoreBtn();\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  try {\n    showLoader();\n    hideLoadMoreBtn();\n\n    const { query, currentPage, totalHits } = currentState;\n\n    let limit = DEFAULT_PER_PAGE;\n    const alreadyRenderedAmount = currentPage * limit;\n    const amountLeft = totalHits - alreadyRenderedAmount;\n\n    if (amountLeft <= 0) {\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      hideLoadMoreBtn();\n      return;\n    }\n\n    if (amountLeft < limit) {\n      limit = amountLeft;\n    }\n\n    const response = await fetchPhotos({ query, page: currentPage + 1, limit });\n\n    currentState.currentPage += 1;\n\n    renderGallery(response.hits);\n\n    const card = document.querySelector('.photo-card');\n    if (card) {\n      const cardHeight = card.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    showLoadMoreBtn();\n  } catch (error) {\n    iziToast.error({\n      message: `Oooops...Something went wrong... ${error.message}`,\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["API_KEY","BASE_URL","DEFAULT_PER_PAGE","defaultQueryParams","defaultState","fetchPhotos","payload","query","page","limit","resolve","queryParamsObject","path","axios","lightbox","SimpleLightbox","gallery","getCardMarkup","item","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","list","markup","loaderContainer","loadMoreBtn","form","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","resetGallery","resetFormInput","currentState","e","searchQuery","iziToast","response","error","currentPage","totalHits","alreadyRenderedAmount","amountLeft","card","cardHeight"],"mappings":"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"}